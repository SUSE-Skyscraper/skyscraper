apiVersion:  skaffold/v2beta28
kind: Config
metadata:
  name: skyscraper-web
build:
  local:
    push: false
  artifacts:
    - image: skyscraper-web
      context: .
      docker:
        dockerfile: docker/skyscraper-web.Dockerfile
    - image: skyscraper-server
      context: .
      docker:
        dockerfile: docker/skyscraper-server.Dockerfile
deploy:
  kubectl:
    manifests:
      - kubernetes/config/gen/skyscraper-server-tls.yaml
      - kubernetes/config/gen/skyscraper-server-config.yaml
      - kubernetes/config/gen/skyscraper-web-tls.yaml
      - kubernetes/config/gen/skyscraper-web-config.yaml
  helm:
    releases:
      - name: skyscraper-web
        chartPath: ../skyscraper-helm-charts/charts/skyscraper
        valuesFiles:
          - kubernetes/helm/skyscraper-values.yaml
        artifactOverrides:
          skyscraper_web.image.name: skyscraper-web
          skyscraper_server.image.name: skyscraper-server
